app-id: com.github.bluesabre.darkbar
runtime: org.gnome.Platform
runtime-version: '42'
sdk: org.gnome.Sdk
command: com.github.bluesabre.darkbar
finish-args:
  - '--filesystem=host:ro'
  - '--filesystem=xdg-config/autostart:create'
  - '--filesystem=/var/lib/flatpak/app:ro'
  - '--filesystem=xdg-data/flatpak/app:ro'
  - '--share=ipc'
  - '--socket=x11'
  - '--system-talk-name=org.freedesktop.Accounts'
  - '--talk-name=org.gnome.SettingsDaemon'

modules:

  - name: libwnck
    buildsystem: meson
    config-opts:
      - "-Dgtk_doc=false"
    cleanup:
      - "/include"
      - "/lib/pkgconfig"
      - "/bin"
    sources:
      - type: git
        url: https://gitlab.gnome.org/GNOME/libwnck.git
        tag: "3.36.0"
        commit: "3c469a0d7e58e36106eea7600ae2f6fd8aaed232"

  - name: xprop
    sources:
      - type: archive
        url: https://xorg.freedesktop.org/archive/individual/app/xprop-1.2.5.tar.gz
        sha256: b7bf6b6be6cf23e7966a153fc84d5901c14f01ee952fbd9d930aa48e2385d670

  - name: xdotool
    no-autogen: true
    make-args:
      - WITHOUT_RPATH_FIX=1
    make-install-args:
      - 'PREFIX=${FLATPAK_DEST}'
      - 'INSTALLMAN=${FLATPAK_DEST}/share/man'
    sources:
      - type: archive
        url: https://github.com/jordansissel/xdotool/archive/v3.20211022.1/xdotool-3.20211022.1.tar.gz
        sha256: 82b15a944a5e82fee15e0f6116bd9f642bc3d0bb6989fc0ca5ad9dfe35de0847
        x-checker-data:
          type: anitya
          project-id: 8648
          stable-only: true
          url-template: https://github.com/jordansissel/xdotool/archive/v$version/xdotool-$version.tar.gz
    cleanup:
      - /share/man

  - name: darkbar
    buildsystem: meson
    sources:
      - type: git
        url: https://github.com/bluesabre/darkbar.git
        commit: "6ad91fd23fe20c8a34947bb5d5319c16831b865c"
        #tag: 1.0.0
        #commit: "919c0100da69de66a4cde077f3444b5387f20a66"